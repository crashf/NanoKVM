import{u as h,r as n,j as e,B as x,a as g,e as w,s as y}from"./index-BsBY1kiT.js";import{C as N,l as T}from"./auth-DBlTaXxA.js";import{R as k,e as v}from"./encrypt-Bln3qwC_.js";import{H as I}from"./head-DzoVp5yL.js";import{M,T as b}from"./index-CORlTqli.js";import{F as o,R as E}from"./LockOutlined-rbhYK5fl.js";import{I as m}from"./http-BsOYHY6A.js";import"./CheckOutlined-DIQU66Zc.js";const{Text:u}=b,C=()=>{const{t}=h(),[s,a]=n.useState(!1),i=()=>{a(!0)},r=()=>{a(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"cursor-pointer text-neutral-300 underline underline-offset-4",onClick:i,children:t("auth.forgetPassword")}),e.jsxs(M,{title:t("auth.forgetPassword"),open:s,onCancel:r,closeIcon:null,footer:null,centered:!0,children:[e.jsx(N,{style:{marginTop:"20px"},children:e.jsxs("div",{className:"flex w-[430px] flex-col space-y-5",children:[e.jsx("div",{children:t("auth.tips.reset1")}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t("auth.tips.reset2")}),e.jsx("a",{href:"https://wiki.sipeed.com/hardware/en/kvm/NanoKVM/reset.html",target:"_blank",children:"wiki"})]}),e.jsxs("ul",{className:"list-outside list-disc",children:[e.jsxs("li",{children:[t("auth.tips.reset3"),e.jsx(u,{code:!0,children:"admin/admin"})]}),e.jsxs("li",{children:[t("auth.tips.reset4"),e.jsx(u,{code:!0,children:"root/root"})]})]})]})}),e.jsx("div",{className:"flex justify-center pb-3 pt-10",children:e.jsx(x,{type:"primary",className:"w-24",onClick:r,children:t("auth.ok")})})]})]})},L=()=>{const t=g(),{t:s}=h(),[a,i]=n.useState(!1),[r,l]=n.useState("");n.useEffect(()=>{w()&&t("/",{replace:!0})},[]),n.useEffect(()=>{r&&setTimeout(()=>l(""),3e3)},[r]);function p(d){if(a)return;i(!0);const f=d.username,j=v(d.password);T(f,j).then(c=>{if(c.code!==0){l(c.code===-2?s("auth.invalidUser"):s("auth.error"));return}l(""),y(c.data.token),t("/",{replace:!0}),window.location.reload()}).catch(()=>{l(s("auth.error"))}).finally(()=>{i(!1)})}return e.jsxs(e.Fragment,{children:[e.jsx(I,{title:s("head.login")}),e.jsx("div",{className:"flex h-screen w-screen flex-col items-center justify-center",children:e.jsxs(o,{style:{minWidth:300,maxWidth:500},initialValues:{remember:!0},onFinish:p,children:[e.jsx("h2",{className:"text-center text-xl font-semibold text-neutral-100",children:s("auth.login")}),e.jsx(o.Item,{name:"username",rules:[{required:!0,message:s("auth.noEmptyUsername"),min:1}],children:e.jsx(m,{prefix:e.jsx(k,{}),placeholder:s("auth.placeholderUsername")})}),e.jsx(o.Item,{name:"password",rules:[{required:!0,message:s("auth.noEmptyPassword"),min:1}],children:e.jsx(m,{prefix:e.jsx(E,{}),type:"password",placeholder:s("auth.placeholderPassword")})}),e.jsx("div",{className:"text-red-500",children:r}),e.jsx(o.Item,{children:e.jsx(x,{type:"primary",htmlType:"submit",className:"w-full",loading:a,children:s("auth.loginButtonText")})}),e.jsx("div",{className:"flex justify-end pb-4 text-sm",children:e.jsx(C,{})})]})})]})};export{L as Login};
